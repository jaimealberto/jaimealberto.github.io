<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Universo Ssh II | </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="Segundo post sobre todo lo relacionado con Ssh">
		<meta property="og:title" content="Universo Ssh II" />
<meta property="og:description" content="Segundo post sobre todo lo relacionado con Ssh" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jaimealberto.github.io/post/11_universosshii/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-08-07T00:00:00+00:00" />


		<meta itemprop="name" content="Universo Ssh II">
<meta itemprop="description" content="Segundo post sobre todo lo relacionado con Ssh"><meta itemprop="datePublished" content="2021-08-07T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-08-07T00:00:00+00:00" />
<meta itemprop="wordCount" content="601">
<meta itemprop="keywords" content="SO,Terminal,Cliente,Utilidades," />
	<link rel="stylesheet" href="/css/bundle.css">
	<link rel="stylesheet" href="/css/custom.css">
	<link rel="stylesheet" href="/css/themes/dark-green.css">
	<link rel="icon" href="/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="/manifest.json">
		
</head>
<body class="body kind-page">
	<header class="header">
	<a class="logo" href="/"></a>
	
<nav class="main-nav" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="/aboutme/">
					
					<span class="main-nav__text">Algo sobre mí ...</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="/about/">
					
					<span class="main-nav__text">La causa ...</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="/recursos/">
					
					<span class="main-nav__text">Recursos</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/">Inicio</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Universo Ssh II</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2021-08-07T00:00:00Z">07-08-2021</time>
<span class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Categories:
		<a class="meta-categories__link" href="/categories/ssh/" rel="category">Ssh</a>, 
		<a class="meta-categories__link" href="/categories/redes/" rel="category">Redes</a>
	</span>
</span>
	</div>
				<h1 class="entry__title">Universo Ssh II</h1>
<details class="entry__toc toc" open>
	<summary class="toc__title">Table of Contents</summary>
	<nav id="TableOfContents">
  <ul>
    <li><a href="#magic-wormhole">Magic Wormhole</a></li>
    <li><a href="#sshuttle">Sshuttle</a>
      <ul>
        <li><a href="#instalación">Instalación</a></li>
        <li><a href="#uso">Uso</a></li>
      </ul>
    </li>
    <li><a href="#sshpass">Sshpass</a></li>
  </ul>
</nav>
</details>
				<div class="entry__content"><figure><img src="/img/ssh2.jpg"/>
</figure>

<p>Después de la <a href="https://jaimealberto.github.io/post/07_universosshi/">primera entrega</a> donde ya vimos lo básico sobre la parte cliente de Ssh y alguna que otra utilidad. Ahora toca ver algunas utilidades mas  que se apoyan en este protocolo.</p>
<h2 id="magic-wormhole">Magic Wormhole</h2>
<p>Ya hablamos de la <a href="/post/07_universosshi/#llaves">generación de llaves</a> para conexión sin contraseña en el <a href="https://jaimealberto.github.io/post/07_universosshi/">post anterior</a>. Uno de los fallos  garrafales, desde mi punto de vista, es la utilización de scp o ssh-copy-id para transferir la llave al servidor remoto desde la parte cliente. Pues durante el proceso solicita la contraseña de usuario y el objetivo es no utilizarla. Bueno para esta tarea tenemos a nuestro amigo <a href="https://github.com/warner/magic-wormhole">Magic-Wormhole</a> el cual tiene implementado una opción para realizar esta acción sin necesidad de contraseña. Si no lo tienes ya instalado puedes consultar el post <a href="/post/08_utilidadesterminali/#magic-wormhole">Utilidades terminal I</a> donde se explica el procedimiento y uso básico.</p>
<p>La parte del servidor por seguridad tiene que invitar al cliente. Esta operación se realiza desde el terminal del servidor logeado con el usuario que tiene que conectarse, lo habitual es que el administrador ( <a href="https://es.wikipedia.org/wiki/Root">root</a> ) invite al usuario, con el siguiente comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh">wormhole ssh invite</code></pre></div>
<p>Esto devolverá una respuesta similar a la siguiente:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh">wormhole ssh accept &lt;Codigo-aleatorio&gt;</code></pre></div>
<p>La respuesta que da la invitacion es la que se tiene que teclar quien la acepta.</p>
<p>Aquí se puede ver el proceso en el servidor ssh que envia la invitación:</p>
<figure><img src="/img/invite.gif"/>
</figure>

<p>En la parte cliente se tendrá que aceptar la invitación tecleando lo indicado en la respuesta del servidor:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh">wormhole ssh accept &lt;Codigo-aleatorio&gt;</code></pre></div>
<p>Aquí se puede ver el proceso en el cliente que acepta la invitación:</p>
<figure><img src="/img/accept.gif"/>
</figure>

<p><em>Nota</em> Si el cliente dispone de varias llaves solicitara cual enviar.</p>
<h2 id="sshuttle">Sshuttle</h2>
<p><a href="https://github.com/sshuttle/sshuttle">Shtutle</a> es un cliente Ssh desarrollado en <a href="https://www.python.org/">Python</a> emula un proxy en modo transparente funcionando como una VPN, no es una VPN como tal. Crea automáticamente reglas utilizando pfctl en MacOs o iptables en Linux para el reenvío de puertos sobre una conexión tunelizada via Ssh. Lo mejor es que esta utilidad abstrae al usuario el tener que realizar manualmente cada reenvío hacia la red remota a la cual queremos acceder.</p>
<p>Realmente a nivel de funcionalidad es como si utilizáramos una VPN, pero todo el trafico se enviá por una única conexión Ssh a través del host remoto el cual realiza la función de puente con múltiples túneles de reenvío. Su principal desarrollador <a href="https://github.com/brianmay">Brian May</a> la define como “ la VPN para el hombre pobre”.</p>
<h3 id="instalación">Instalación</h3>
<p>MacOs</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh">brew install sshttule</code></pre></div>
<p>Tambien esta disponible en la mayoria de distribuciones Linux y Windows ( con <a href="https://cygwin.com/install.html">cygwin</a> instalado)</p>
<p>*Nota: En el caso de Windows se complica el uso de esta herramienta. Se propone instalar una máquina <a href="https://sshuttle.readthedocs.io/en/stable/windows.html">virtual Linux</a> en modo puente que haga la conexión con sshuttle y desde la máquina anfitrión Windows enrutar todo el tráfico hacia la máquina Linux.</p>
<h3 id="uso">Uso</h3>
<p>Desde el terminal:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-zsh" data-lang="zsh">sshutle -v --dns -r usuario@ip 0/0</code></pre></div>
<p>De este modo enviamos todo el trafico por el túnel creado por Shuttle.</p>
<pre><code>-v modo verbose
-- dns tunelizado de tráfico DNS. 
</code></pre><h2 id="sshpass">Sshpass</h2>
<p>Sshpass, es una utilidad diseñada para ejecutar ssh usando de modo no interactivo, utiliza el acceso a la TTY para simular que la contraseña es escrita por un usuario final.  Por mi parte solo la aconsejo utilizar en caso que necesitamos pasar la contraseña en el código de programación. Cosa que no es nada segura. Su gran desventaja es la visualización de la contraseña en texto plano, por este motivo no lo veo un método seguro.</p>
<p>Por este motivo no voy a explicar su uso, pero si es necesario mencionarlo dado que puede que en alguna circunstancia sea necesario. De ser así, aconsejo utilizar <a href="https://es.wikipedia.org/wiki/GNU_Privacy_Guard">Gpg</a> o <a href="https://github.com/charmbracelet/charm">Charm</a>.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="/tags/so/">SO</a>
			<a class="entry__tag btn" href="/tags/terminal/">Terminal</a>
			<a class="entry__tag btn" href="/tags/cliente/">Cliente</a>
			<a class="entry__tag btn" href="/tags/utilidades/">Utilidades</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Share on Telegram" href="https://t.me/share/url?url=https%3a%2f%2fjaimealberto.github.io%2fpost%2f11_universosshii%2f&amp;title=Universo%20Ssh%20II" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Share on LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjaimealberto.github.io%2fpost%2f11_universosshii%2f&title=Universo%20Ssh%20II" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Share on LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="JaimeAlberto avatar" src="/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				JaimeAlberto
			</div>
			<div class="author__bio">The BOFH of this Site</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Related</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="/post/07_universosshi/">Universo Ssh I</a></li>
		
		<li class="related__item"><a class="related__link" href="/post/01_tipsmacos01/">Tips &amp; Tricks MacOS I de ?</a></li>
		
	</ul>
</div>

	

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://linkedin.com/in/jaimealbertoio">
			<svg class="social__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/jaimealberto">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
</div>
<div class="footer__links mt">
	<a class="footer__link" href="/licencia/">Licencia CC BY-NC-SA 4.0</a>
</div>
	<div class="footer__copyright">© 2021 JaimeAlberto. <span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span></div>
</footer>
<script src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="/js/custom.js"></script>
</body>
</html>