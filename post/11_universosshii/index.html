<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Universo Ssh II - </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="Segundo post sobre todo lo relacionado con Ssh">
		<meta property="og:title" content="Universo Ssh II" />
<meta property="og:description" content="Segundo post sobre todo lo relacionado con Ssh" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jaimealberto.github.io/post/11_universosshii/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-08-07T00:00:00+00:00" />


		<meta itemprop="name" content="Universo Ssh II">
<meta itemprop="description" content="Segundo post sobre todo lo relacionado con Ssh"><meta itemprop="datePublished" content="2021-08-07T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-08-07T00:00:00+00:00" />
<meta itemprop="wordCount" content="601">
<meta itemprop="keywords" content="SO,Terminal,Cliente,Utilidades," />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/logo.png">
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menú</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">La causa ...</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/aboutme/">
				
				<span class="menu__text">Algo sobre mí ...</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/">
				
				<span class="menu__text">Artículos</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/combos/">
				
				<span class="menu__text">Combos</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/raspberrypi/">
				
				<span class="menu__text">Raspberry Pi</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/vida/">
				
				<span class="menu__text">Vidas</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/recetas/">
				
				<span class="menu__text">Recetas</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/recursos/">
				
				<span class="menu__text">Recursos</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Universo Ssh II</h1>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">JaimeAlberto</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2021-08-07T00:00:00Z">07-08-2021</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/ssh/" rel="category">Ssh</a>, <a class="meta__link" href="/categories/redes/" rel="category">Redes</a>
	</span>
</div></div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Índice</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#magic-wormhole">Magic Wormhole</a></li>
    <li><a href="#sshuttle">Sshuttle</a>
      <ul>
        <li><a href="#instalación">Instalación</a></li>
        <li><a href="#uso">Uso</a></li>
      </ul>
    </li>
    <li><a href="#sshpass">Sshpass</a></li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<figure><img src="/img/ssh2.jpg"/>
</figure>

<p>Después de la <a href="https://jaimealberto.github.io/post/07_universosshi/">primera entrega</a> donde ya vimos lo básico sobre la parte cliente de Ssh y alguna que otra utilidad. Ahora toca ver algunas utilidades mas  que se apoyan en este protocolo.</p>
<h2 id="magic-wormhole">Magic Wormhole</h2>
<p>Ya hablamos de la <a href="/post/07_universosshi/#llaves">generación de llaves</a> para conexión sin contraseña en el <a href="https://jaimealberto.github.io/post/07_universosshi/">post anterior</a>. Uno de los fallos  garrafales, desde mi punto de vista, es la utilización de scp o ssh-copy-id para transferir la llave al servidor remoto desde la parte cliente. Pues durante el proceso solicita la contraseña de usuario y el objetivo es no utilizarla. Bueno para esta tarea tenemos a nuestro amigo <a href="https://github.com/warner/magic-wormhole">Magic-Wormhole</a> el cual tiene implementado una opción para realizar esta acción sin necesidad de contraseña. Si no lo tienes ya instalado puedes consultar el post <a href="/post/08_utilidadesterminali/#magic-wormhole">Utilidades terminal I</a> donde se explica el procedimiento y uso básico.</p>
<p>La parte del servidor por seguridad tiene que invitar al cliente. Esta operación se realiza desde el terminal del servidor logeado con el usuario que tiene que conectarse, lo habitual es que el administrador ( <a href="https://es.wikipedia.org/wiki/Root">root</a> ) invite al usuario, con el siguiente comando:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span>wormhole ssh invite</span></span></code></pre></div>
<p>Esto devolverá una respuesta similar a la siguiente:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span>wormhole ssh accept &lt;Codigo-aleatorio&gt;</span></span></code></pre></div>
<p>La respuesta que da la invitacion es la que se tiene que teclar quien la acepta.</p>
<p>Aquí se puede ver el proceso en el servidor ssh que envia la invitación:</p>
<figure><img src="/img/invite.gif"/>
</figure>

<p>En la parte cliente se tendrá que aceptar la invitación tecleando lo indicado en la respuesta del servidor:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span>wormhole ssh accept &lt;Codigo-aleatorio&gt;</span></span></code></pre></div>
<p>Aquí se puede ver el proceso en el cliente que acepta la invitación:</p>
<figure><img src="/img/accept.gif"/>
</figure>

<p><em>Nota</em> Si el cliente dispone de varias llaves solicitara cual enviar.</p>
<h2 id="sshuttle">Sshuttle</h2>
<p><a href="https://github.com/sshuttle/sshuttle">Shtutle</a> es un cliente Ssh desarrollado en <a href="https://www.python.org/">Python</a> emula un proxy en modo transparente funcionando como una VPN, no es una VPN como tal. Crea automáticamente reglas utilizando pfctl en MacOs o iptables en Linux para el reenvío de puertos sobre una conexión tunelizada via Ssh. Lo mejor es que esta utilidad abstrae al usuario el tener que realizar manualmente cada reenvío hacia la red remota a la cual queremos acceder.</p>
<p>Realmente a nivel de funcionalidad es como si utilizáramos una VPN, pero todo el trafico se enviá por una única conexión Ssh a través del host remoto el cual realiza la función de puente con múltiples túneles de reenvío. Su principal desarrollador <a href="https://github.com/brianmay">Brian May</a> la define como “ la VPN para el hombre pobre”.</p>
<h3 id="instalación">Instalación</h3>
<p>MacOs</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span>brew install sshttule</span></span></code></pre></div>
<p>Tambien esta disponible en la mayoria de distribuciones Linux y Windows ( con <a href="https://cygwin.com/install.html">cygwin</a> instalado)</p>
<p>*Nota: En el caso de Windows se complica el uso de esta herramienta. Se propone instalar una máquina <a href="https://sshuttle.readthedocs.io/en/stable/windows.html">virtual Linux</a> en modo puente que haga la conexión con sshuttle y desde la máquina anfitrión Windows enrutar todo el tráfico hacia la máquina Linux.</p>
<h3 id="uso">Uso</h3>
<p>Desde el terminal:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span>sshutle -v --dns -r usuario@ip 0/0</span></span></code></pre></div>
<p>De este modo enviamos todo el trafico por el túnel creado por Shuttle.</p>
<pre tabindex="0"><code>-v modo verbose
-- dns tunelizado de tráfico DNS. 
</code></pre><h2 id="sshpass">Sshpass</h2>
<p>Sshpass, es una utilidad diseñada para ejecutar ssh usando de modo no interactivo, utiliza el acceso a la TTY para simular que la contraseña es escrita por un usuario final.  Por mi parte solo la aconsejo utilizar en caso que necesitamos pasar la contraseña en el código de programación. Cosa que no es nada segura. Su gran desventaja es la visualización de la contraseña en texto plano, por este motivo no lo veo un método seguro.</p>
<p>Por este motivo no voy a explicar su uso, pero si es necesario mencionarlo dado que puede que en alguna circunstancia sea necesario. De ser así, aconsejo utilizar <a href="https://es.wikipedia.org/wiki/GNU_Privacy_Guard">Gpg</a> o <a href="https://github.com/charmbracelet/charm">Charm</a>.</p>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/so/" rel="tag">SO</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/terminal/" rel="tag">Terminal</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/cliente/" rel="tag">Cliente</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/utilidades/" rel="tag">Utilidades</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="JaimeAlberto avatar" src="/img/avatar.png" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">Sobre el autor JaimeAlberto</span>
	</div>
	<div class="authorbox__description">
		The BOFH of this Site
	</div>
</div>



			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
<div class="footer__links">
	<a class="footer__link" href="/licencia/">Licencia CC BY-NC-SA 4.0</a>
</div>
		<div class="footer__copyright">
			&copy; 2022 JaimeAlberto.
			<span class="footer__copyright-credits">Generado con <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> y <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a>.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="/js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>